<div *hideItBootstrap="['xs','sm']">
    <div class="custom-list" [@routerTransition]>
        <div class="row margin-bottom-5">
            <div class="col-xs-6">
                <div class="page-head">
                    <div class="page-title">
                        <h1>
                            <span>{{l("BookingOrder.List")}}</span>
                        </h1>
                        <div>
                            <breadcrumb></breadcrumb>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xs-6 text-right">
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12">
                <div class="card">
                    <form class="form-horizontal">
                        <div class="card-header card-header-text" data-background-color="orange">
                            <h6 class="card-title">{{l("Search")}}</h6>
                        </div>

                        <div class="card-content">
                            <div class="row">
                                <!-- 姓名  -->
                                <div class="col-xs-6">
                                    <div class="common-max-width">
                                        <label class="col-md-3 label-on-left">{{l("BookingOrder.Name")}}</label>
                                        <div class="col-md-9">
                                            <div class="form-group label-floating is-empty">
                                                <label class="control-label"></label>
                                                <input class="form-control common-max-width" [(ngModel)]="customerName" type="text" name="customerName" placeholder="{{l('BookingOrder.Name')}}">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 预约项目名称  -->
                                <div class="col-xs-6">
                                    <div class="common-max-width">
                                        <label class="col-md-3 label-on-left">{{l('BookingOrder.BookingName')}}</label>
                                        <div class="col-md-9">
                                            <div class="form-group label-floating is-empty">
                                                <label class="control-label"></label>
                                                <input class="form-control common-max-width" [(ngModel)]="bookingName" type="text" name="bookingName" placeholder="{{l('BookingOrder.BookingName')}}">
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div [hidden]="!spreadMoreService.spreadMoreStatus.active">
                                    <!-- 性别  -->
                                    <div class="col-xs-6">
                                        <div class="common-max-width">
                                            <label class="col-md-3 label-on-left">{{l('BookingOrder.Gender')}}</label>
                                            <div class="col-md-9">
                                                <div class="form-group label-floating is-empty">
                                                    <label class="control-label"></label>
                                                    <kendo-dropdownlist [data]="genderSelectListData" [(ngModel)]="gender" name="gender" [textField]="'displayText'" [valueField]="'value'"
                                                        [valuePrimitive]="true" [defaultItem]="selectDefaultItem"></kendo-dropdownlist>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 预约日期  -->
                                    <div class="col-xs-6">
                                        <div class="common-max-width">
                                            <label class="col-md-3 label-on-left">{{l('BookingOrder.Date')}}</label>
                                            <div class="col-md-9">
                                                <div class="form-group label-floating is-empty">
                                                    <label class="control-label"></label>
                                                    <div class="flatpickr-wrap">
                                                        <input class="form-control common-max-width" id="bookingDate" [(ngModel)]="bookingDate" type="text" name="bookingDate" placeholder="{{l('BookingOrder.Date')}}">
                                                        <a class="input-button flatpickr-toggle" title="{{l('Switch')}}" data-toggle>
                                                            <i class="vapps-icon-dc-calendar"></i>
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 电话号码  -->
                                    <div class="col-xs-6">
                                        <div class="common-max-width">
                                            <label class="col-md-3 label-on-left">{{l('BookingOrder.PhoneNumber')}}</label>
                                            <div class="col-md-9">
                                                <div class="form-group label-floating is-empty">
                                                    <label class="control-label"></label>
                                                    <input class="form-control common-max-width" [(ngModel)]="phoneNumber" type="text" name="phoneNumber" placeholder="{{l('BookingOrder.PhoneNumber')}}">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 创建时间  -->
                                    <div class="col-xs-6">
                                        <div class="common-max-width">
                                            <label class="col-md-3 label-on-left">{{l('BookingOrder.CreationTime')}}</label>
                                            <div class="col-md-9" style="padding-right: 0; padding-left: 0;">
                                                <div class="col-md-6">
                                                    <div class="form-group label-floating is-empty">
                                                        <label class="control-label"></label>
                                                        <div class="flatpickr-wrap">
                                                            <input class="form-control" id="startCreationTime" [(ngModel)]="creationStartDate" type="text" name="startCreationTime" placeholder="{{l('Search.CreationTime.ChooseStart')}}"
                                                                data-input>
                                                            <a class="input-button flatpickr-toggle" title="{{l('Switch')}}" data-toggle>
                                                                <i class="vapps-icon-dc-calendar"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group label-floating is-empty">
                                                        <label class="control-label"></label>
                                                        <div class="flatpickr-wrap">
                                                            <input class="form-control" id="endCreationTime" [(ngModel)]="creationEndDate" type="text" name="endCreationTime" placeholder="{{l('Search.CreationTime.ChooseEnd')}}"
                                                                data-input>
                                                            <a class="input-button flatpickr-toggle" title="{{l('Switch')}}" data-toggle>
                                                                <i class="vapps-icon-dc-calendar"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 预约状态  -->
                                    <div class="col-xs-6">
                                        <div class="common-max-width">
                                            <label class="col-md-3 label-on-left">{{l('BookingOrder.Status')}}</label>
                                            <div class="col-md-9">
                                                <div class="form-group label-floating is-empty">
                                                    <label class="control-label"></label>
                                                    <kendo-dropdownlist [data]="orderStatusSelectList" (valueChange)="orderStatusChangeHandle($event)" [textField]="'displayText'"
                                                        [valueField]="'value'" [valuePrimitive]="true" [defaultItem]="selectDefaultItem"></kendo-dropdownlist>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- 签到状态  -->
                                    <div class="col-xs-6">
                                        <div class="common-max-width">
                                            <label class="col-md-3 label-on-left">{{l('Booking.CheckInState')}}</label>
                                            <div class="col-md-9">
                                                <div class="form-group label-floating is-empty">
                                                    <label class="control-label"></label>
                                                    <kendo-dropdownlist [data]="checkInSelectListData" [(ngModel)]="checkIn" name="checkIn" [textField]="'displayText'" [valueField]="'value'"
                                                        [valuePrimitive]="true" [defaultItem]="selectDefaultItem"></kendo-dropdownlist>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row btn-wrap">
                                <div class="col-xs-6 col-md-2 col-md-offset-4 col-sm-3 col-sm-offset-3 common-min-width">
                                    <div class="text-center spread-more">
                                        <button class="btn btn-block primary-bgcolor" (click)="spreadMoreService.toggleStatus()">
                                            <i class="fa " [ngClass]="{'fa-chevron-down': !spreadMoreService.spreadMoreStatus.active, 'fa-chevron-up': spreadMoreService.spreadMoreStatus.active}"></i>
                                            <span>{{ spreadMoreService.spreadMoreStatus.text }}</span>
                                        </button>
                                    </div>
                                </div>

                                <div class="col-xs-6 col-md-2 col-sm-3 common-min-width">
                                    <div class="text-center">
                                        <button class="btn btn-block primary-bgcolor" (click)="searchData()" [buttonBusy]="searching" [busyText]="l('Searching')">
                                            <i class="fa fa-search"></i>
                                            <span>{{l("Search")}}</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12">
                <div class="card no-top-margin">
                    <div class="card-content no-padding">
                        <!-- [pageable]=" { buttonCount: gridParam.ButtonCount, info: gridParam.Info, type: gridParam.Type, pageSizes: gridParam.PageSizes, previousNext: gridParam.PreviousNext }" -->
                        <kendo-grid GridRowClick (editRow)="editRowHandle($event)" [data]="customerListData | async" [pageSize]="gridParam.MaxResultCount"
                            [skip]="gridParam.SkipCount" [sort]="gridParam.Sorting" [pageable]=" { buttonCount: gridParam.ButtonCount, info: gridParam.Info, type: gridParam.Type, pageSizes: gridParam.PageSizes, previousNext: gridParam.PreviousNext }"
                            [sortable]="false" (dataStateChange)="dataStateChange($event)" [scrollable]="'none'" (pageChange)="pageChange($event)">
                            <kendo-grid-messages noRecords="{{l('NoDataAvailable')}}" pagerItemsPerPage="{{l('ItemsPerPage')}}" pagerOf="{{l('PagerOf')}}"
                                pagerItems="{{l('Items')}}" pagerNextPage="{{l('NextPage')}}" pagerPreviousPage="{{l('PreviousPage')}}"
                                pagerFirstPage="{{l('FirstPage')}}" pagerLastPage="{{l('LastPage')}}"></kendo-grid-messages>

                            <!-- 订单状态  -->
                            <kendo-grid-column title="{{l('BookingOrder.Status')}}">
                                <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                                    <span class="order-status" [ngClass]="'status-'+dataItem.status">{{ displayStatus[dataItem.status-1] }}</span>
                                </ng-template>
                            </kendo-grid-column>

                            <!-- 应约人 -->
                            <kendo-grid-column title="{{l('BookingOrder.Name')}}">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <img [src]="transferAvatarPictureUrl(dataItem.profilePictureUrl)" style="width:50px;" alt="avatar" class="avatar">
                                    <span>{{ dataItem.customerName }}</span>
                                </ng-template>
                            </kendo-grid-column>

                            <!-- 预约项目名称 -->
                            <kendo-grid-column title="{{l('BookingOrder.BookingName')}}">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <span>{{ dataItem.bookingName }}</span>
                                </ng-template>
                            </kendo-grid-column>

                            <!-- 预约门店 -->
                            <kendo-grid-column title="{{l('BookingOrder.Outlet')}}">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <span>{{ dataItem.outletName }}</span>
                                </ng-template>
                            </kendo-grid-column>

                            <!-- 预约时间 -->
                            <kendo-grid-column title="{{l('BookingOrder.Datetime')}}">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <span>{{ t(dataItem.bookingDate,'YYYY-MM-DD') }} {{ dataItem.hourOfDay }}</span>
                                </ng-template>
                            </kendo-grid-column>

                            <!-- 应约人数 -->
                            <kendo-grid-column title="{{l('BookingOrder.SubscriberNum')}}">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <span>{{ dataItem.subscriberNum }}</span>
                                </ng-template>
                            </kendo-grid-column>

                            <!-- 电话 -->
                            <kendo-grid-column title="{{l('BookingOrder.PhoneNumber')}}">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <span>{{ dataItem.phoneNum }}</span>
                                </ng-template>
                            </kendo-grid-column>

                            <!-- 订单创建时间 -->
                            <kendo-grid-column title="{{l('BookingOrder.CreationTime')}}">
                                <ng-template kendoGridCellTemplate let-dataItem>
                                    <span>{{ t(dataItem.creationTime) }}</span>
                                </ng-template>
                            </kendo-grid-column>
                        </kendo-grid>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <xiaoyuyue-customer-info-model #customerForEditModelComponent (isShowModelHander)="hiddenOrderModelHandle($event)"></xiaoyuyue-customer-info-model>
</div>

<div *showItBootstrap="['xs','sm']">
    <div class="mobile-custom-list common-container">
        <div class="top-action-wrap row">
            <div class="flex-right">
                <div class="col-xs-6">
                    <div class="item clearfix">
                        <span class="pull-left"></span>
                        <span class="select pull-right">
                            <kendo-dropdownlist [data]="availableDatesSelectListData" (valueChange)="bookingDateChangeHandler($event)" [textField]="'text'"
                                [valueField]="'value'" [valuePrimitive]="true" [defaultItem]="bookingDateSelectDefaultItem"></kendo-dropdownlist>
                        </span>
                    </div>
                </div>

                <div class="col-xs-6">
                    <div class="item clearfix">
                        <span class="pull-left"></span>
                        <span class="select pull-right">
                            <kendo-dropdownlist [data]="availableTimesSelectListData" (valueChange)="bookingTimeChangeHandler($event)" [textField]="'text'"
                                [valueField]="'value'" [valuePrimitive]="true" [defaultItem]="bookingTimeSelectDefaultItem"></kendo-dropdownlist>
                        </span>
                    </div>
                </div>
            </div>
            <div class="flex-left"></div>
        </div>

        <div class="scroll-wrapper">
            <xiaoyuyue-list-scroll [height]="'calc(100vh - 110px)'" [isNeedPullUpLoad]="'true'" [isNeedPullDownRefresh]="'true'" (finishPullUpHandle)="pullUpLoad()"
                (finishPullDownHandle)="pullDownRefresh()">
                <div class="scroll-content">
                    <div class="card" *ngIf="allMobileCustomerListData.length > 0">
                        <div class="card-content">
                            <div class="content-item" *ngFor="let customerListItem of allMobileCustomerListData">
                                <div class="flex-item" (click)="showCustomerForEditHandle(item.id)" *ngFor="let item of customerListItem">
                                    <div class="flex-left">
                                        <div class="avatar" [ngStyle]="{'background-image': 'url(' + transferAvatarPictureUrl(item.profilePictureUrl) + ')'}"></div>
                                    </div>
                                    <div class="flex-right">
                                        <div class="pull-left info">
                                            <p class="name">{{ item.customerName }}</p>
                                            <p class="state">{{ bookingOrderStatusName[item.status-1] }}</p>
                                        </div>
                                        <div class="pull-right time-ago">
                                            <span>{{ getTimeAgo(item.creationTime) }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </xiaoyuyue-list-scroll>
        </div>

    </div>
    <xiaoyuyue-customer-info-model #customerForEditModelComponent (isShowModelHander)="hiddenMobileOrderModelHandle($event)"></xiaoyuyue-customer-info-model>
</div>